"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("inferno"),n=require("inferno-extras");function r(e){return void 0===e||null===e}function t(e){return null===e||!1===e||!0===e||void 0===e}function o(e,n){var r={};if(e)for(var t in e)r[t]=e[t];if(n)for(var o in n)r[o]=n[o];return r}var d,i,l=!1,u=0,f=!1;function a(e){return{key:e.key,props:e.props,ref:e.ref,type:e.type}}function c(e){if(null===e)return!0;var n=document.body,r=e;do{if(null===(r=r.parentNode))return!0}while(r!==n);return!1}function p(e,n){var r=e.flags;if((512&r)>0)return null;var t,d=n?n._renderedChildren:null,i=(16&r)>0||0!==(16&e.childFlags),l=e.childFlags;if(1===l)t=null;else if(12&l){t=[];for(var u=0;u<e.children.length;++u)t.push(m(e.children[u],d?d[u]:null))}else 2===l&&(t=[m(e.children,d?d[0]:d)]);return{_currentElement:(16&r)>0?e.children+"":{props:e.className?o(e.props,{className:e.className}):e.props,type:1024&r?"InfernoPortal":e.type},_renderedChildren:t,_stringText:i?e.children+"":null,vNode:e}}function s(e,n){(4&e.flags)>0?y(e.children?e.children.$LI:null,n._renderedComponent,n):(8&e.flags)>0?y(e.children,n._renderedComponent,n):g(e.childFlags,e.children,n)}function _(e,n){var r=e.flags,t=(4&r)>0?e.children:e.type,d={_currentElement:a(e),_instance:t,props:e.props,state:t&&t.state,vNode:e};if(!n){if(t&&t.forceUpdate){var i=t.forceUpdate.bind(t);t.forceUpdate=d.forceUpdate=function(n){if(!f)return;if(d.props=e.props=o(d.props,d._currentElement.props),!l&&!t.$BR&&!t.QU)return l=!0,i(n),s(t.$LI,d._renderedComponent),void(l=!1);i(n)}}if(t&&t.setState){var u=t.setState.bind(t);t.setState=d.setState=function(e,n){if(!f)return;if(!l&&!t.$BR&&!t.QU)return l=!0,u(e,n),s(t.$LI,d._renderedComponent),void(l=!1);u(e,n)}}}if((14&r)>0){var c=(4&r)>0?e.children?e.children.$LI:null:e.children;c&&(d._renderedComponent=m(c,n?n._renderedComponent:null))}return d}function m(e,n){var r=(1521&e.flags)>0?p(e,n):_(e,n);if(n)return o(n,r);return r}function v(){return"."+u++}function C(e){for(var n=document.body.querySelectorAll("*"),r=0;r<n.length;++r){var t=n[r].$V;t&&N(t)&&(e[v()]=m(t))}}function h(e){if(!e||null===e._instance)return;if(d.mountComponent(e),e._renderedComponent)h(e._renderedComponent);else if(e._renderedChildren)for(var n=0;n<e._renderedChildren.length;++n)h(e._renderedChildren[n])}function g(e,n,r){var t,o=r._renderedChildren,i=o?o.length:0;switch(e){case 2:if(y(n,o?o[0]:null,r),i>1)for(t=1;t<i;++t)d.unmountComponent(o[t]);break;case 16:r._stringText=n+"";break;case 8:case 4:var l=n.length,u=l>i?i:l;for(t=0;t<u;++t)y(n[t],o[t],r,t);if(i<l)for(t=u;t<l;++t){var f=m(n[t]);o||(o=r._renderedChildren=[]),o.push(f),h(f)}else if(i>l)for(t=u;t<i;++t)d.unmountComponent(o.pop());break;case 1:for(t=0;t<i;++t)d.unmountComponent(o[t]);r._renderedChildren=null}}function N(n){if(!(16384&n.flags))return!1;var r=e.findDOMfromVNode(n,!0);if(!r)return!1;var t=r.parentNode;if(!t)return!1;return Boolean(t&&t.$V===n)}function y(e,n,r,t){if(!n&&e)return void O(e,r,t);if(n&&e){var o=n.vNode;e.type===o.type&&e.key===o.key?((16&e.flags)>0&&n._stringText?(n._currentElement=e.children+"",n._stringText=e.children+""):(4&e.flags)>0?y(e.children?e.children.$LI:null,n._renderedComponent,n):(8&e.flags)>0?y(e.children,n._renderedComponent,n):g(e.childFlags,e.children,n),n.vNode=e,null!==n._instance&&d.receiveComponent(n)):(d.unmountComponent(n),O(e,r,t))}else!e&&n&&(r._renderedChildren?r._renderedChildren=[]:r._renderedComponent&&(r._renderedComponent=null),d.unmountComponent(n))}function O(e,n,t){var o=m(e);n&&(n._renderedComponent?n._renderedComponent=o:r(t)?n._renderedChildren?n._renderedChildren.splice(0,n._renderedChildren.length-1,o):n._renderedChildren=[o]:n._renderedChildren[t]=o),h(o)}function b(){var r={getNodeFromInstance:function(e){return n.findDOMNode(e.vNode)},getClosestInstanceFromNode:function(e){for(;e&&!e.$V;)e=e.parentNode;return e?m(e.$V):null}},o=Object.create(null);i={_instancesByReactRootID:o,_renderNewRootComponent:function(e){return e}},d={mountComponent:function(e){return e},performUpdateIfNecessary:function(e){return e},receiveComponent:function(e){return e},unmountComponent:function(e){return e}};var l=e.options.renderComplete;function u(e){if(e.source!==window||!e.data||"react-devtools-content-script"!==e.data.source||!e.data.payload)return;var n=e.data.payload.type;"resume"===n||"callback"===n&&!f?(f=!0,C(o)):"pause"===n&&(f=!1,o=Object.create(null))}return e.options.renderComplete=function(r,u){if(!f)return;if(!t(r)){var a,p;if(u.$V){for(a in o){var s=o[a],_=e.findDOMfromVNode(s.vNode,!0);if(c(_)){d.unmountComponent(s),delete o[a];break}if(_===n.findDOMNode(r))return void y(r,s)}(p=m(r))._rootNodeID=v(),o[p._rootNodeID]=p,h(p),i._renderNewRootComponent(p)}else if(c(n.findDOMNode(r)))for(a in o){var C=o[a];if(c(n.findDOMNode(C.vNode)))return d.unmountComponent(C),void delete o[a]}l&&l(r,u)}},window.addEventListener("message",u),{ComponentTree:r,Mount:i,Reconciler:d,_listener:u}}function w(){if("undefined"===typeof window.__REACT_DEVTOOLS_GLOBAL_HOOK__)return;window.__REACT_DEVTOOLS_GLOBAL_HOOK__.inject(b())}exports.initDevTools=w;
